/* ==========================================================================
   VAULTEX THEME â€” App Shell Layout
   Structural containers: app grid, sidebars, workspace, content row.
   ========================================================================== */

/* --- App container --- */
.app-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100dvh;
  background: var(--bg-base);
  overflow: hidden;
}

/* Mobile overlay backdrop */
.sidebar-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.65);
  z-index: 99;
  opacity: 0;
  transition: opacity var(--t-slow);
}
.sidebar-overlay.active {
  display: block;
  opacity: 1;
}

/* --- Activity bar (permanent narrow icon column) --- */
.activity-bar {
  width: var(--activity-bar-width);
  min-width: var(--activity-bar-width);
  height: 100%;
  background: var(--bg-secondary);
  border-right: 1px solid var(--divider);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--sp-2) 0;
  flex-shrink: 0;
  z-index: 11;
}
.activity-bar.sidebar-collapsed {
  background: var(--bg-primary);
  transition: background 200ms ease;
}

.btn-icon {
  width: 30px;
  height: 27px;
}

.activity-btn {
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  color: var(--text-muted);
  border-radius: var(--radius-sm);
  cursor: pointer;
  position: relative;
  transition: color var(--t-fast), background var(--t-fast);
}
.activity-btn:hover { background: var(--bg-hover); color: var(--text-normal); }
.activity-btn.active { color: var(--text-normal); }
.activity-btn.active::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 2px;
  height: 16px;
  background: var(--accent-color);
  border-radius: 0 2px 2px 0;
}

/* --- Left sidebar shell --- */
.sidebar-left {
  width: var(--sidebar-left-width);
  min-width: var(--sidebar-left-width);
  height: 100%;
  background: var(--bg-secondary);
  border-right: 1px solid var(--divider);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: width var(--t-slow), min-width var(--t-slow), transform var(--t-slow);
  flex-shrink: 0;
  z-index: 10;
}
.sidebar-left.collapsed {
  width: 0;
  min-width: 0;
  border-right-width: 0;
  overflow: hidden;
}
.sidebar-left-inner {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  width: var(--sidebar-left-width);
}

/* --- Workspace row (left sidebar + content + right sidebar, below tab bar) --- */
.workspace-row {
  flex: 1;
  min-height: 0;
  display: flex;
  background: var(--bg-primary);
  overflow: hidden;
}

/* --- Tab bar --- */
.tab-bar {
  display: flex;
  align-items: center;
  height: var(--tab-bar-height);
  background: var(--bg-secondary-alt);
  flex-shrink: 0;
  padding: 0;
  gap: 0;
  overflow: visible;
  position: relative;
  z-index: 1;
}

/* Sidebar zone: mirrors the sidebar width and collapses with it */
.tab-bar-left-spacer {
  width: calc(var(--activity-bar-width) + var(--sidebar-left-width));
  min-width: calc(var(--activity-bar-width) + var(--sidebar-left-width));
  flex-shrink: 0;
  display: flex;
  align-items: center;
  padding: 0 var(--sp-1);
  overflow: hidden;
  transition: width var(--t-slow), min-width var(--t-slow), border-color var(--t-slow);
}
.tab-bar-left-spacer.spacer-collapsed {
  width: var(--activity-bar-width);
  min-width: var(--activity-bar-width);
  border-right-color: transparent;
}

#toggle-left {
  margin-right: 10px;
  margin-left: 2px;
}

.sidebar-toggle-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  color: var(--text-muted);
  padding: 0;
  border-radius: var(--radius-sm);
  flex-shrink: 0;
  padding: var(--sp-1);
  transition: background var(--t-fast), color var(--t-fast);
}
.sidebar-toggle-btn:hover { background: var(--bg-hover); color: var(--text-normal); }

.tab-strip {
  flex: 1;
  align-self: stretch;
  display: flex;
  align-items: flex-end;
  gap: 2px;
  overflow: hidden;
  min-width: 0;
  padding: 0 var(--sp-4);
}

.tab {
  display: flex;
  align-items: center;
  padding: 0 var(--sp-2);
  height: 35px;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md) var(--radius-md) 0 0;
  border-bottom: none;
  font-size: var(--font-size-sm);
  color: var(--text-normal);
  white-space: nowrap;
  overflow: hidden;
  max-width: 200px;
  min-width: 200px;
  position: relative;
  margin-bottom: -1px;
  z-index: 2;
}
.tab-icon { color: var(--text-muted); flex-shrink: 0; }
.tab-title { overflow: hidden; text-overflow: ellipsis; flex: 1; padding-right: 12px; }

.tab-close {
  position: absolute;
  right: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  text-decoration: none;
  transition: background var(--t-fast), color var(--t-fast);
}
.tab-close:hover { background: var(--bg-hover); color: var(--text-normal); }

.tab-bar-actions {
  display: flex;
  align-items: center;
  gap: var(--sp-1);
  flex-shrink: 0;
  padding-right: var(--sp-2);
}

/* --- Main note view --- */
.note-view {
  flex: 1;
  min-width: 0;
  overflow-y: auto;
  padding: var(--sp-10) var(--sp-8);
}

/* Constrain content width and center it */
.note-article,
.post-list,
.archive-list,
.categories-grid,
.tags-page-cloud,
.note-header + .post-list,
.note-header + .archive-list {
  max-width: var(--content-max-width);
  margin-left: auto;
  margin-right: auto;
}

.note-header {
  max-width: var(--content-max-width);
  margin: 0 auto var(--sp-6);
}

/* --- Right sidebar shell --- */
.sidebar-right {
  width: var(--sidebar-right-width);
  min-width: var(--sidebar-right-width);
  height: 100%;
  background: var(--bg-secondary);
  border-left: 1px solid var(--divider);
  overflow-y: auto;
  flex-shrink: 0;
  transition: width var(--t-slow), min-width var(--t-slow);
}
.sidebar-right.collapsed {
  width: 0;
  min-width: 0;
  border-left-width: 0;
  overflow: hidden;
}
.sidebar-right-inner {
  padding: var(--sp-4) 0 var(--sp-8);
  min-width: var(--sidebar-right-width);
}
